<template>
  <section>
    <button class="main-button" @click="downloadAsImage">
      <svg
        width="30"
        height="30"
        fill="currentColor"
        viewBox="0 0 24 24"
        xmlns="http://www.w3.org/2000/svg"
      >
        <path
          d="M15.75 5.125a3.125 3.125 0 1 1 .754 2.035l-8.397 3.9a3.124 3.124 0 0 1 0 1.88l8.397 3.9a3.125 3.125 0 1 1-.61 1.095l-8.397-3.9a3.125 3.125 0 1 1 0-4.07l8.397-3.9a3.125 3.125 0 0 1-.144-.94Z"
        ></path>
      </svg>
    </button>
    <div class="sumarry" ref="sumarry">
      <img
        src="../assets/img/sdutacm_logo_colorful-02a05aa9.svg"
        alt=""
        class="back"
      />
      <div class="topoj">SDUT Online Judge</div>
      <div class="results-summary-container">
        <div class="confetti">
          <div class="confetti-piece"></div>
          <div class="confetti-piece"></div>
          <div class="confetti-piece"></div>
          <div class="confetti-piece"></div>
          <div class="confetti-piece"></div>
          <div class="confetti-piece"></div>
          <div class="confetti-piece"></div>
          <div class="confetti-piece"></div>
          <div class="confetti-piece"></div>
          <div class="confetti-piece"></div>
          <div class="confetti-piece"></div>
          <div class="confetti-piece"></div>
          <div class="confetti-piece"></div>
          <div class="confetti-piece"></div>
          <div class="confetti-piece"></div>
          <div class="confetti-piece"></div>
          <div class="confetti-piece"></div>
          <div class="confetti-piece"></div>
          <div class="confetti-piece"></div>
        </div>
        <div class="results-summary-container__result">
          <div class="heading-tertiary">ä½ çš„OJå¹´æŠ¥<span>ğŸ¥³</span></div>
          <div class="result-box">
            <img src="../assets/img/qq.png" alt="" />
          </div>
          <div class="result-text-box">
            <div class="heading-secondary">ATRIOR</div>
            <div class="paragraph">
              <div class="ac-num">
                <p>æ€»AC:<span>1111</span></p>
                <p>ä»Šå¹´AC:<span>234</span></p>
                <p>90%</p>
              </div>
              <div class="rating">
                Rating:<span class="rating-color">1900</span>
              </div>
              <div class="achiv-num">æ€»æˆå°±æ•°:<span>89</span></div>
              <div class="contests">
                <li
                  v-for="(item, index) in contests"
                  :key="index"
                  class="bisai"
                >
                  <span>{{ item.name }}</span>
                  <span>{{ item.rank }}</span>
                </li>
              </div>
            </div>
          </div>
        </div>
        <div class="results-summary-container__options">
          <div class="tag-head">2024å›å¿†æ ‡ç­¾âœ¨ï¸</div>
          <!-- <div class="heading-secondary heading-secondary--blue">Summary</div> -->
          <ul class="summary-result-options">
            <li v-for="(item, index) in tags" :key="index" class="tag">
              {{ item }}
            </li>
          </ul>
        </div>
      </div>
    </div>
  </section>
</template>

<script setup>
import { nextTick, onMounted, ref } from "vue";
import html2canvas from "html2canvas";
const sumarry = ref(null);
const tags = ref([
  "åˆ·é¢˜ç‹",
  "å¤œçŒ«å­",
  "ç™¾æŠ˜ä¸æŒ ",
  "åŸç¥å¯åŠ¨!",
  "æ ¡èµ›æ˜æ˜Ÿ",
  "æ–°æ˜Ÿ",
  "é˜Ÿä¼çš„ç¾ç»Š",
]);
const contests = ref([
  {
    name: "æ“‚å°èµ›",
    rank: 12,
  },
  {
    name: "æ–°ç”Ÿèµ›",
    rank: 12,
  },
  {
    name: "æ ¡èµ›",
    rank: 12,
  },
  {
    name: "åŸç¥èµ›",
    rank: 12,
  },
]);

// onMounted(() => {
function downloadAsImage() {
  nextTick(() => {
    if (sumarry.value) {
      html2canvas(sumarry.value).then((canvas) => {
        // å°† canvas è½¬æ¢ä¸ºå›¾ç‰‡ URL
        const imgUrl = canvas.toDataURL("image/png");
        // åˆ›å»ºä¸€ä¸ªä¸‹è½½é“¾æ¥
        const link = document.createElement("a");
        link.href = imgUrl;
        link.download = "webpage_image.png"; // è®¾ç½®ä¸‹è½½æ–‡ä»¶å
        link.click(); // æ¨¡æ‹Ÿç‚¹å‡»ä¸‹è½½
      });
    } else {
      console.log("null");
    }
  });
  // ä½¿ç”¨ html2canvas æˆªå– #content å…ƒç´ çš„å†…å®¹
}
// });
</script>

<style scoped>
@import url("../assets/sumarry.css");
</style>
